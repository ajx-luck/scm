---- C:\Users\edwar\Desktop\CMS79F5118_5139程序\Timer_Demo\Timer0_Demo.c ----------------------------------------------------------------------
1:                /*-------------------------------------------
2:                
3:                程序名称：Timer0定时中断程序
4:                日期版本：2019/12/27 <V1.1>
5:                
6:                备注：	  定时时间计算方法
7:                          定时时间T = {1/[(Fosc/4)*预分频比]}*(256-TMR0)
8:                          本程序计算示例：
9:                          T = {1/[(8/4)*1/2]}*(256-131)
10:               		    = 125 us
11:               
12:               *本程序由 中微半导体有限公司 &应用支持部& 编写整理
13:               *公司网址 www.mcu.com.cn
14:               *技术支持QQ 3001082102  罗工
15:                           3001085706	陈工
16:               -------------------------------------------*/
17:               
18:               #include <cms.h>
19:               
20:               
21:               void main()
  0010    0000    NOP
  0011    0064    CLRWDT
22:               {
23:               	asm("nop");
24:               	asm("clrwdt");
25:               	
26:               	OSCCON = 0x71;			//8MHZ,内部振荡器用作系统时钟
  0012    3071    LDIA	0x71
  0013    1683    SETB	0x3,5
  0014    1303    CLRB	0x3,6
  0015    008F    LD	0xF,A
27:               
28:               //---------------------------------------	
29:               	OPTION_REG = 0xD0;		//Timer0使用内部时钟Focs/4，预分频比为1:2
  0016    30D0    LDIA	0xD0
  0017    0081    LD	0x1,A
30:               	TMR0 = 131;				//赋予初始值
  0018    3083    LDIA	0x83
  0019    1283    CLRB	0x3,5
  001A    0081    LD	0x1,A
31:               	INTCON = 0xA0;			//允许所有未被屏蔽的中断、禁止外设中断，使能Timer0
  001B    30A0    LDIA	0xA0
  001C    008B    LD	0xB,A
32:               //---------------------------------------		
33:               	
34:               	TRISB = 0x00;
  001D    1683    SETB	0x3,5
  001E    0186    CLR	0x6
35:               	PORTB = 0x00;
  001F    1283    CLRB	0x3,5
  0020    0186    CLR	0x6
36:               
37:               	while(1)			
  0021    0064    CLRWDT
  0022    2821    JP	0x21
38:               	{
39:               		asm("clrwdt");
40:               	}
41:               }
42:               
43:               
44:               /***********************************************
45:               函数名称：Timer0_Isr
46:               函数功能：中断服务
47:               入口参数：无
48:               出口参数：无
49:               备注：
50:               ************************************************/
51:               void interrupt Timer0_Isr()
52:               {
53:               	if(T0IF)
  0023    1D0B    SNZB	0xB,2
  0024    282C    JP	0x2C
54:               	{
55:               	//---------------------------------------
56:               		TMR0 += 131;		//重新赋初值，在赋值前Timer0已有计数，故在该基础上加初值
  0025    3083    LDIA	0x83
  0026    1283    CLRB	0x3,5
  0027    1303    CLRB	0x3,6
  0028    0781    ADDR	0x1
57:               	//---------------------------------------
58:               			
59:               		T0IF = 0;			//清中断标志位
  0029    110B    CLRB	0xB,2
60:               		
61:               		PORTB ^= 0xff;
  002A    30FF    LDIA	0xFF
  002B    0686    XORR	0x6
  002C    0871    LD	A,0x71
  002D    008A    LD	0xA,A
  002E    0E70    SWAPA	0x70
  002F    0083    LD	0x3,A
  0030    0EFE    SWAPR	0x7E
  0031    0E7E    SWAPA	0x7E
  0032    0009    RETI
62:               	}
63:               }
---- stringtab ------------------------------------------------------------------
---- reset_enter ------------------------------------------------------------------
  0000    118A    CLRB	0xA,3
  0001    280B    JP	0xB
  000B    118A    CLRB	0xA,3
  000C    280D    JP	0xD
---- start_initialization ------------------------------------------------------------------
---- interrupt_function_enter ----------------------------------------------------------
  0004    00FE    LD	0x7E,A
  0005    0E03    SWAPA	0x3
  0006    00F0    LD	0x70,A
  0007    080A    LD	A,0xA
  0008    00F1    LD	0x71,A
  0009    118A    CLRB	0xA,3
  000A    2823    JP	0x23
---- common_function ------------------------------------------------------------------
  000D    0183    CLR	0x3
  000E    118A    CLRB	0xA,3
  000F    2810    JP	0x10

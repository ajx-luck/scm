---- H:\MyDownloads\说明书&测试报告\开发包\SC8P171XE开发包\SC8P171XE_C_demo\SC8P171XE_INT\PB_Interrupt_Demo.c ----------------------------------------------------------------------
1:                /*-------------------------------------------
2:                功能：PORB电平变化中断演示
3:                版本：V1.0
4:                日期：2021.01.05 
5:                
6:                *本程序由 中微半导体 &应用支持部& 编写整理
7:                *公司网址 www.mcu.com.cn
8:                *
9:                -------------------------------------------*/
10:               
11:               #include <sc.h>
12:               
13:               
14:               void main()
15:               {
16:               	asm("nop");
17:               	asm("clrwdt");
18:               	
19:               	OSCCON = 0x70;			//内部振荡器用作系统时钟
  000F    3070    LDIA	0x70
  0010    1683    SETB	0x3,5
  0011    008F    LD	0xF,A
20:               	OPTION_REG = 0;			//预分频寄存器设置
  0012    0181    CLR	0x1
21:               	TRISA = 0;
  0013    0185    CLR	0x5
22:               //---------------------------------------	
23:               	WPUB = 0B00001000;		//使能上拉，使RB3为高
  0014    3008    LDIA	0x8
  0015    0095    LD	0x15,A
24:               	TRISB = 0B00001000;		//设置RB3的IO口为输入
  0016    0086    LD	0x6,A
25:               	IOCB = 0B00001000;		//允许RB3的IO口电平变化中断
  0017    0096    LD	0x16,A
26:               	RBIE = 1;				//使能PORTB电平变化中断
  0018    158B    SETB	0xB,3
27:               	INTCON = 0xC8;			//允许所有未被屏蔽的中断、允许外设中断，禁止INT外部中断
  0019    30C8    LDIA	0xC8
  001A    008B    LD	0xB,A
28:               	PORTB;					//读取PORTA并锁存
  001B    1283    CLRB	0x3,5
  001C    0806    LD	A,0x6
29:               //---------------------------------------		
30:               
31:               	while(1)			
  001D    0064    CLRWDT
  001E    281D    JP	0x1D
32:               	{
33:               		asm("clrwdt");
34:               	}
35:               }
36:               
37:               
38:               /***********************************************
39:               函数名称：PB_Isr
40:               函数功能：PB电平变化中断服务
41:               入口参数：无
42:               出口参数：无
43:               备注：
44:               ************************************************/
45:               void interrupt PB_Isr()
46:               {
47:               	if(RBIF)
  001F    1C0B    SNZB	0xB,0
  0020    2826    JP	0x26
48:               	{
49:               		PORTB;				//读取PORTB状态
  0021    1283    CLRB	0x3,5
  0022    0806    LD	A,0x6
50:               		RBIF = 0;			//清中断标志
  0023    100B    CLRB	0xB,0
51:               		RA0 = !RA0;
  0024    3001    LDIA	0x1
  0025    0685    XORR	0x5
  0026    0871    LD	A,0x71
  0027    008A    LD	0xA,A
  0028    0E70    SWAPA	0x70
  0029    0083    LD	0x3,A
  002A    0EFE    SWAPR	0x7E
  002B    0E7E    SWAPA	0x7E
  002C    0009    RETI
52:               	}
53:               }
---- stringtab ------------------------------------------------------------------
---- reset_enter ------------------------------------------------------------------
  0000    280A    JP	0xA
  000A    280B    JP	0xB
---- start_initialization ------------------------------------------------------------------
---- interrupt_function_enter ----------------------------------------------------------
  0004    00FE    LD	0x7E,A
  0005    0E03    SWAPA	0x3
  0006    00F0    LD	0x70,A
  0007    080A    LD	A,0xA
  0008    00F1    LD	0x71,A
  0009    281F    JP	0x1F
---- common_function ------------------------------------------------------------------
  000B    0183    CLR	0x3
  000C    280D    JP	0xD
  000D    0000    NOP
  000E    0064    CLRWDT

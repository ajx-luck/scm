---- H:\MyDownloads\说明书&测试报告\开发包\SC8P171XE开发包\SC8P171XE_C_demo\SC8P171XE_LVD\SC8P171XE_LVD.c ----------------------------------------------------------------------
1:                /*-------------------------------------------
2:                功能：LVD模块演示
3:                版本：V1.0
4:                日期：2021.01.04 
5:                
6:                *本程序由 中微半导体 &应用支持部& 编写整理
7:                *公司网址 www.mcu.com.cn
8:                
9:                -------------------------------------------*/
10:               
11:               #include <sc.h>
12:               
13:               void main()
14:               {
15:               	asm("nop");
16:               	asm("clrwdt");
17:               	
18:               	OSCCON = 0x70;			//内部振荡器用作系统时钟
  000F    3070    LDIA	0x70
  0010    1683    SETB	0x3,5
  0011    008F    LD	0xF,A
19:               	OPTION_REG = 0;			//预分频寄存器设置	
  0012    0181    CLR	0x1
20:               		
21:               	LVDCON = 0x07;			//LVD电压设定3.0V,使能LVD
  0013    3007    LDIA	0x7
  0014    0091    LD	0x11,A
22:               							//LVD使能后需延时1ms才可以读取LVD_RES，且VDD变化后1ms，LVD_RES才有输出
23:               	INTCON = 0xC0;			//允许所有未被屏蔽的中断、允许外设中断	
  0015    30C0    LDIA	0xC0
  0016    008B    LD	0xB,A
24:               	PIE2 = 0x01;			//允许LVD中断
  0017    3001    LDIA	0x1
  0018    008D    LD	0xD,A
  0019    281C    JP	0x1C
25:               //---------------------------------------		
26:               
27:               	while(1)			
  001C    0064    CLRWDT
28:               	{
29:               		asm("clrwdt");
30:               		if (LVD_RES)		//VDD<3V,则LVD_RES=1
  001D    1683    SETB	0x3,5
  001E    1B91    SZB	0x11,7
  001F    281A    JP	0x1A
31:               			RA2 = 1;
  001A    1283    CLRB	0x3,5
  001B    1505    SETB	0x5,2
32:               		else
33:               			RA2 = 0;
  0020    1283    CLRB	0x3,5
  0021    1105    CLRB	0x5,2
  0022    281C    JP	0x1C
34:               	}
35:               }
36:               
37:               /***********************************************
38:               函数名称：LVD_Isr
39:               函数功能：LVD中断服务
40:               入口参数：无
41:               出口参数：无
42:               备注：
43:               ************************************************/
44:               void interrupt LVD_Isr()
45:               {
46:               	if(LVDIF)				//VDD < LVD设定电压值(3.0V)
  0023    1283    CLRB	0x3,5
  0024    180D    SZB	0xD,0
47:               	{
48:               		LVDIF = 0;			//清中断标志		
  0025    100D    CLRB	0xD,0
  0026    0871    LD	A,0x71
  0027    008A    LD	0xA,A
  0028    0E70    SWAPA	0x70
  0029    0083    LD	0x3,A
  002A    0EFE    SWAPR	0x7E
  002B    0E7E    SWAPA	0x7E
  002C    0009    RETI
49:               	}
50:               }
---- stringtab ------------------------------------------------------------------
---- reset_enter ------------------------------------------------------------------
  0000    280A    JP	0xA
  000A    280B    JP	0xB
---- start_initialization ------------------------------------------------------------------
---- interrupt_function_enter ----------------------------------------------------------
  0004    00FE    LD	0x7E,A
  0005    0E03    SWAPA	0x3
  0006    00F0    LD	0x70,A
  0007    080A    LD	A,0xA
  0008    00F1    LD	0x71,A
  0009    2823    JP	0x23
---- common_function ------------------------------------------------------------------
  000B    0183    CLR	0x3
  000C    280D    JP	0xD
  000D    0000    NOP
  000E    0064    CLRWDT

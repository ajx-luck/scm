---- C:\mcuproject\scm\SC8P171XE开发包\SC8P171XE_C_demo\SC8P171XE_Timer\SC8P171XE_Timer2.c ----------------------------------------------------------------------
1:                /*-------------------------------------------
2:                功能：TMR2演示
3:                版本：V1.0
4:                日期：2021.01.04 
5:                
6:                *本程序由 中微半导体 &应用支持部& 编写整理
7:                *公司网址 www.mcu.com.cn
8:                
9:                -------------------------------------------*/
10:               
11:               /*-------------------------------------------
12:               备注：	  定时时间计算方法
13:                         时钟输入为系统指令时钟（即为Fosc/4）
14:                         定时时间T = {1/[(Fosc/4)*预分频比*后分频比]}*(PR2+1)
15:                         本程序计算示例：
16:                         T = {1/[(8/4)*0.25*1]}*250
17:               		    = 125 us
18:               -------------------------------------------*/ 
19:               
20:               #include <sc.h>
21:               
22:               void main(void)
  000D    0000    NOP
  000E    0064    CLRWDT
23:               {
24:               	asm("nop");
25:               	asm("clrwdt");
26:               	OSCCON = 0X70;				//8M
  000F    3070    LDIA	0x70
  0010    1683    SETB	0x3,5
  0011    008F    LD	0xF,A
27:               	
28:               	TRISA = 0;
  0012    0185    CLR	0x5
29:               	TRISB = 0;					//PORTB口作输出口
  0013    0186    CLR	0x6
30:               		
31:               	PR2 = 249;					//设定Timer初始值，定时周期是250*4/8M=125uS
  0014    30F9    LDIA	0xF9
  0015    0092    LD	0x12,A
32:               	TMR2IF = 0;
  0016    1283    CLRB	0x3,5
  0017    108C    CLRB	0xC,1
33:               	TMR2IE = 1;					//使能Timer2溢出中断
  0018    1683    SETB	0x3,5
  0019    148C    SETB	0xC,1
34:               	
35:               	T2CON = 0B00000100;			//开启Timer2,设置TMR2的分频比为1:1
  001A    3004    LDIA	0x4
  001B    1283    CLRB	0x3,5
  001C    0092    LD	0x12,A
36:               	
37:               	INTCON = 0XC0;				//开启总中断
  001D    30C0    LDIA	0xC0
  001E    008B    LD	0xB,A
38:               	while(1)
  001F    0064    CLRWDT
  0020    281F    JP	0x1F
39:               	{
40:               		asm("clrwdt");
41:               	}
42:               }
43:               /***********************************************
44:               函数名称：Timer2_Isr
45:               函数功能：中断服务
46:               入口参数：无
47:               出口参数：无
48:               备注：
49:               ************************************************/
50:               void interrupt Timer1_Isr(void)
51:               {
52:               	if(TMR2IF)
  0021    1283    CLRB	0x3,5
  0022    1C8C    SNZB	0xC,1
  0023    2827    JP	0x27
53:               	{
54:               		TMR2IF = 0;
  0024    108C    CLRB	0xC,1
55:               		
56:               		PORTB ^= 0XFF;
  0025    30FF    LDIA	0xFF
  0026    0686    XORR	0x6
  0027    0871    LD	A,0x71
  0028    008A    LD	0xA,A
  0029    0E70    SWAPA	0x70
  002A    0083    LD	0x3,A
  002B    0EFE    SWAPR	0x7E
  002C    0E7E    SWAPA	0x7E
  002D    0009    RETI
57:               	}
58:               }
---- stringtab ------------------------------------------------------------------
---- reset_enter ------------------------------------------------------------------
  0000    280A    JP	0xA
  000A    280B    JP	0xB
---- start_initialization ------------------------------------------------------------------
---- interrupt_function_enter ----------------------------------------------------------
  0004    00FE    LD	0x7E,A
  0005    0E03    SWAPA	0x3
  0006    00F0    LD	0x70,A
  0007    080A    LD	A,0xA
  0008    00F1    LD	0x71,A
  0009    2821    JP	0x21
---- common_function ------------------------------------------------------------------
  000B    0183    CLR	0x3
  000C    280D    JP	0xD
